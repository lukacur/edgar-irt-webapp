<div class="p-3">
    <h2 class="text-purple-600 text-lg inline-block me-3">Create an exercise definition</h2>

    <hr class="my-3">

    <div class="mt-3 mx-2" [formGroup]="exerciseDefinitionForm">
        <div>
            <app-searchable-select
                labelText="Select a course"
        
                [multi]="false"
                [searchable]="true"
                [selectableItems]="(courses$ | async) ?? []"
        
                textKey="text"
                valueKey="course"
        
                [useObjectAsValue]="false"

                [control]="exerciseDefinitionForm.get('selectedCourse')!"
            ></app-searchable-select>
        </div>

        <div *ngIf="(exerciseDefinitionForm.get('selectedCourse')?.value ?? null) !== null">
            <h2 class="text-purple-600">Define a new exercise</h2>
    
            <div>
                <label class="text-sm">Exercise name</label>
                <input
                    type="text"
                    formControlName="exerciseName"
                    class="p-3 bg-white border border-slate-500/50 rounded w-full"
                >
            </div>

            <div class="mt-3">
                <mat-checkbox
                    formControlName="customProgression"
                    (change)="
                        ($event.checked) ?
                            progressionCustomization.classList.remove('hidden') :
                            progressionCustomization.classList.add('hidden')
                    "
                >Use customized progression?</mat-checkbox>

                <div #progressionCustomization class="hidden mt-3">
                    <h2 class="text-purple-600">Customize progression</h2>
                    <hr class="mt-3">

                    <div class="mt-3">
                        <label class="text-sm">
                            Sequential correct answers required to upgrade question difficulty
                        </label>
                        <input
                            class="w-full p-3 rounded border border-slate-400/25"
                            type="number"
                            min="1"
                            formControlName="correctAnswersToUpgrade"
                        >
                    </div>

                    <div class="mt-3">
                        <label class="text-sm">
                            Sequential incorrect answers required to downgrade question difficulty
                        </label>
                        <input
                            class="w-full p-3 rounded border border-slate-400/25"
                            type="number"
                            min="1"
                            formControlName="incorrectAnswersToDowngrade"
                        >
                    </div>

                    <div class="mt-3">
                        <label class="text-sm">
                            Sequential skipped questions required to downgrade question difficulty
                        </label>
                        <input
                            class="w-full p-3 rounded border border-slate-400/25"
                            type="number"
                            min="1"
                            formControlName="skippedQuestionsToDowngrade"
                        >
                    </div>
                </div>
            </div>
    
            <div class="mt-3">
                <button
                    mat-flat-button
                    color="primary"
                    (click)="defineNewExercise()"
                >Define a new exercise</button>
            </div>
        </div>
    </div>
</div>
